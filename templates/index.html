{% extends "layout.html" %}
{% block title %}Welcome{% endblock %}
{% block script %}
<script type="text/javascript">
function hideTitle() {
    $('.hideonclick').css('display', "none").end();
}
$("#fileupload").on("click", hideTitle);
$(document).bind('drop dragover', function (e) {
    $('.hideonclick').css('display', "none").end();
});
$(function () {
    $('#fileupload').fileupload({
        dropZone: $('body'),
        dataType: 'json',
        done: function (e, data) {
            if (data.result.error != '') {
                $('#error').text(data.result.error);
                $('#upload-helper').text("ERROR");
                $('#hint').text("WHOOPS ----->");
            }
            if (data.result.artist != null) {
                $('#upload-helper').text("FINISHED");
                $('#hint').text("TRY AGAIN ----->");
                $('.finish').css('opacity', "0.5").end()
                $('#song').text(data.result.name);
                $('#artist').text("- " + data.result.artist);
                $('#url').val(data.result.url);
                $('#songpage').attr('href', data.result.url)
                $('.show').css('display', 'inline-block').end()
            }
        }
    });
});
$('#fileupload').bind('fileuploadprogress', function (e, data) {
    $('.finish').css('opacity', "1").end()
    $('.show').css('display', 'none').end()
    $('#song').text("");
    $('#artist').text("");
    $('#url').val("");
    $('#upload-helper').text("UPLOADING");
    $('#hint').text("HOLD ON ----->");
    $('.finish-line').css('display', 'inline-block').end()
    $('#progress-bar').css('width', parseInt(data.loaded / data.total * 100, 10) + '%').end()
    if ((parseInt(data.loaded / data.total * 100, 10)) == 100) {
        $('#upload-helper').text("DOIN MAGIC");
    };
});
</script>
{% endblock %}
{% block content %}
            <div class="row welcome finish">
            	<div class="span6 offset5 hideonclick">
            			<p class="muted centered medium-text">THIS IS LYRE</p>
            			<p class="silent centered medium-text">PANTS ON FYRE</p>
            	</div>
            	<div class="span6 offset6 title-image">
            	</div>
            </div>
            <div class="row welcome finish hideonclick">
            	<div class="span8 offset4">
            			<p class="centered large-text">LYRE IS FOR SHARING MUSIC</p>
            			<p class="beaten centered large-text">FOR A SHORT AMOUNT OF TIME</p>
            	</div>
            </div>
            <div class="row finish">
                <div class="span6 offset5">
                    <div id="progress-bar"></div><div class="finish-line"></div>
                </div>
            </div>
            <div class="row files finish">
      		    <div class="span3 offset2 hint">
      	     		<span id="hint" class="silent medium-text">TRY IT -----></span>
          		</div>
          		<div class="upload span2 offset1">
                        <span class="upload-button fileinput-button">
                            <span id="upload-helper" class="centered upload-text">PICK SONG</span>
            	            <input id="fileupload" type="file" name="file" data-url="/upload">
                        </span>
                </div>
            </div>
            <div class="row files">
            <div id="error" class="medium-text centered error-red"></div>
                <div class="span12 offset2">
                    <p class="centered medium-text"><a id="songpage" href=""><span class="upper" id="song"></span> <span class="upper" id="artist"></span></a></p>
                </div>
                <input id="url" class="centered span8 offset4" disabled="true"></span>
            </div>
{% endblock %}